# AUDIT NOTEPAD
│   │   │   │   └── DoubleJumpRateModel.sol
│   │   │   │   └── PTokenModule.sol
│   │   │       └── RiskEngineModule.sol
├── OracleEngine.sol
### SCOPE

# GTDA METHODS

# GOALS

# TAGS

# DIAGRAM
```````````````````````````````````````````````
Oracle Engine

what for? The Oracle Engine is the price feed system that supplies Pike’s lending/borrowing modules (e.g., PTokenModule) with asset valuations. Because this component informs liquidations, borrowing limits, and collateral values, it is mission-critical and high-value for attackers.

Key Features

Multi-Oracle Support: Compatible with Chainlink, Pyth

Fallback Mechanism: Configurable secondary oracle with price validation

Governance Control: Protocol governor manages all oracle configurations

Price Validation: Automatic bounds checking between main and fallback oracles
```````````````````````````````````````````````

# ATTACKS
## 1. Oracle Engine
```````````````````````````````````````````````

1. Oracle Manipulation / Spoofed Price Data
Risk: If the primary oracle (e.g., Chainlink or Pyth) is compromised or misconfigured, prices can be manipulated to trigger wrongful liquidations or inflate collateral values.

Attack Vector:

If fallback validation is weak or misaligned, attacker can:

Feed a fake high price → over-borrow

Feed a fake low price → force victim liquidation

Especially critical if:

Protocol doesn’t enforce min/max deviation bounds strictly.

Oracle contracts are upgradable without delay.

✅ Mitigation (should be audited):

Ensure fallback check logic compares within a safe deviation threshold (e.g., ±5%)

Revert on significant disagreement.

Log all oracle switch events.

```````````````````````````````````````````````
```````````````````````````````````````````````
2. Governance Hijack -> Oracle Reconfiguration

Risk: If governance (admin powers) key (private key) is compromised, oracle sources can be swapped to malicious ones.

Exploit Scenario:

Attacker gains access to governance address (via compromised private key, upgrade bug, or DAO vote)

Reconfigures all price feeds to custom, self-operated oracle

Fakes prices and drains liquidity

✅ Mitigation:

Audit setOracleConfig() and any similar config logic.

Enforce time-locks and quorum thresholds for sensitive oracle actions.
```````````````````````````````````````````````
```````````````````````````````````````````````
3. Inconsistent Price Returns / after Oracle Downtime

Fallback Manipulation

Risk: If the primary oracle fails and the fallback is lagging or returns stale data, protocol may still proceed with incorrect assumptions.

Examples:

Liquidation based on outdated price → wrongful asset seizure.

Manipulated fallback → circumvent checks.

✅ Mitigation:

Validate updatedAt timestamps.

Require both oracles to be within certain recency & deviation limits.

Fallback only if primary has a hard failure, not just “out of range”.

```````````````````````````````````````````````
```````````````````````````````````````````````
4. Reentrancy via Oracle Callback (if Pull-based oracle with Pike (Asynchronous response))

Risk: If any price oracle is pull-based and calls back, and Pike’s OracleEngine performs external call within state-changing logic, it may open the door for reentrancy or unexpected callback manipulation.

✅ Mitigation:

Strictly separate external calls from sensitive state updates.

Use checks-effects-interactions pattern.
```````````````````````````````````````````````
```````````````````````````````````````````````
5. Decimal Mismatch / Unit Conversion Bugs
Risk: Oracles like Chainlink may return prices in 8 decimals, while others (e.g., Pyth) may use 18 decimals or vary. If Pike doesn't normalize price units before usage, calculations can be catastrophically wrong.

✅ Mitigation:

Normalize all oracle inputs to consistent units.

Explicitly log priceDecimals in every call or config.
```````````````````````````````````````````````

A. EXTERNAL FUNCTION: 

1. Reentrancy : Classic, cross-function, cross-contract, read-only

Is to call back or change a function in unwanted condition

2. DoS (Denial of Service) : 

Ways of Attacks: Untrusted Address Revert, Blacklist Address, Contract don't have payable function, Function that does not exist, Return data not as expected

Make the transaction revert so users can't withdrawl deposit in web3

3. Gas Griefing : Forwarding all gas (63/64) -> (1/64) -> not enaugh -> DoS -> revert

4. Return Values : Gas griefing expected is unexpected, unexpected values, unexpected return format

Unexpected return format -> revert

## NOTES

## FINDINGS

